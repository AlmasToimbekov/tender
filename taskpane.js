!function(){"use strict";var e,t,n,o,r={14385:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},98362:function(e,t,n){e.exports=n.p+"assets/logo-filled.png"},58394:function(e,t,n){e.exports=n.p+"e829cd2cf0cf550f6022.css"}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return r[e](n,n.exports,s),n.exports}s.m=r,s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,{a:t}),t},s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e}(),s.b=document.baseURI||self.location.href,function(){async function e(){const e=document.getElementById("run");e.disabled=!0,e.classList.add("disabled");try{await Excel.run((async e=>{const t=e.workbook.getSelectedRange();t.load("rowIndex, rowCount"),await e.sync();const n=t.rowIndex+1,o=`A${n}:F${n+t.rowCount-1}`,r=e.workbook.worksheets.getActiveWorksheet().getRange(o);r.load("values"),await e.sync();const a=r.values.map((e=>e[2])),s=await async function(e){try{const t=[];for(const n of e){let e=await fetch(`https://apiba.prgapp.kz/CompanyFullInfo?id=${n}&lang=ru`,{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8,ru;q=0.7",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="126", "Google Chrome";v="126"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"cross-site",Referer:"https://ba.prg.kz/","Referrer-Policy":"strict-origin-when-cross-origin"},body:null,method:"GET"}),o=await e.json();t.push(o)}return t}catch(e){return console.error("Error fetching data:",e),[]}}(a);await async function(e,t){console.log("selectedRangeAddress",t);const n=e.map((e=>[e.basicInfo.ceo.value?.title,e.basicInfo.addressRu.value,e.gosZakupContacts?.phone?.length>0?e.gosZakupContacts.phone.map((e=>e.value)).join("; "):"",e.basicInfo.registrationDate.value,e.basicInfo.primaryOKED.value,e.basicInfo.secondaryOKED.value?.join("; ")])),o=["name","address","phone","registration","primary","secondary"];await Excel.run((async e=>{const r=e.workbook.worksheets.getActiveWorksheet(),a=r.getRange(t);a.load("columnIndex, rowIndex, rowCount"),await e.sync();const s=a.rowIndex,c=r.getRangeByIndexes(0,6,1,o.length);c.values=[o],c.copyFrom(r.getRange("A1"),"Formats");const i=r.getRangeByIndexes(s,6,n.length,n[0].length);i.values=n,i.format.autofitColumns();[1,4,5].forEach((e=>{const t=r.getRangeByIndexes(s,6+e,n.length+1,1);t.format.columnWidth=400,t.format.wrapText=!0})),await e.sync()}))}(s,o)}))}catch(e){console.error(e)}finally{e.disabled=!1,e.classList.remove("disabled")}}Office.onReady((t=>{t.host===Office.HostType.Excel&&(document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=e)}))}(),e=s(14385),t=s.n(e),n=new URL(s(58394),s.b),o=new URL(s(98362),s.b),t()(n),t()(o)}();
//# sourceMappingURL=taskpane.js.map