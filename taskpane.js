!function(){"use strict";var e,t,o,n,r={14385:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},98362:function(e,t,o){e.exports=o.p+"assets/logo-filled.png"},58394:function(e,t,o){e.exports=o.p+"ab4ea6b7ff5749888c03.css"}},a={};function c(e){var t=a[e];if(void 0!==t)return t.exports;var o=a[e]={exports:{}};return r[e](o,o.exports,c),o.exports}c.m=r,c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,{a:t}),t},c.d=function(e,t){for(var o in t)c.o(t,o)&&!c.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;c.g.importScripts&&(e=c.g.location+"");var t=c.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var n=o.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=o[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),c.p=e}(),c.b=document.baseURI||self.location.href,function(){async function e(){try{await Excel.run((async e=>{const t=e.workbook.getSelectedRange();t.load("rowIndex, rowCount"),await e.sync();const o=t.rowIndex+1,n=`A${o}:F${o+t.rowCount-1}`,r=e.workbook.worksheets.getActiveWorksheet().getRange(n);r.load("values"),await e.sync();const a=r.values.map((e=>e[2])),c=await async function(e){try{const t=[];for(const o of e){let e=await fetch(`https://apiba.prgapp.kz/CompanyFullInfo?id=${o}&lang=ru`,{headers:{accept:"*/*","accept-language":"en-GB,en-US;q=0.9,en;q=0.8,ru;q=0.7",priority:"u=1, i","sec-ch-ua":'"Not/A)Brand";v="8", "Chromium";v="126", "Google Chrome";v="126"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"Windows"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"cross-site",Referer:"https://ba.prg.kz/","Referrer-Policy":"strict-origin-when-cross-origin"},body:null,method:"GET"}),n=await e.json();t.push(n)}return t}catch(e){return console.error("Error fetching data:",e),[]}}(a);await async function(e,t){console.log("selectedRangeAddress",t);const o=e.map((e=>[e.basicInfo.ceo.value?.title,e.basicInfo.addressRu.value,e.gosZakupContacts?.phone?.length>0?e.gosZakupContacts.phone.map((e=>e.value)).join("; "):"",e.basicInfo.registrationDate.value,e.basicInfo.primaryOKED.value,e.basicInfo.secondaryOKED.value?.join("; ")])),n=["name","address","phone","registration","primary","secondary"];await Excel.run((async e=>{const r=e.workbook.worksheets.getActiveWorksheet(),a=r.getRange(t);a.load("columnIndex, rowIndex, rowCount"),await e.sync();const c=a.rowIndex,s=r.getRangeByIndexes(0,6,1,n.length);s.values=[n],s.copyFrom(r.getRange("A1"),"Formats");const i=r.getRangeByIndexes(c,6,o.length,o[0].length);i.values=o,i.format.autofitColumns();[1,4,5].forEach((e=>{const t=r.getRangeByIndexes(c,6+e,o.length+1,1);t.format.columnWidth=400,t.format.wrapText=!0})),await e.sync()}))}(c,n)}))}catch(e){console.error(e)}}Office.onReady((t=>{t.host===Office.HostType.Excel&&(document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=e)}))}(),e=c(14385),t=c.n(e),o=new URL(c(58394),c.b),n=new URL(c(98362),c.b),t()(o),t()(n)}();
//# sourceMappingURL=taskpane.js.map